(function(){!function($){$.fn.stackGrid=function(t,e){var i,n,o,r,u,s,a,d,c;return n=this,i=$(window),a=!0,c={width:0,height:0,update:function(){}},c.update=function(){c.width=i.width()},s=$.extend({ignore:null,columnWidth:196,numberOfColumns:4,gutter:16,isFluid:0,isOptimized:0,move:function(t,e,i,n){return t.stop().animate({left:e,top:i},n)},scale:function(t,e,i,n){return t.stop().animate({width:e,height:i})}},e),o={computedNumberOfColumns:0,plot:function(){}},o.properties={columnWidth:s.columnWidth,gutter:s.gutter,numberOfColumns:s.numberOfColumns,isFluid:s.isFluid,isOptimized:s.isOptimized,update:function(){}},o.container={self:$(n),width:0,height:0,scale:function(){}},o.data={columnWidth:void 0,gutter:void 0,numberOfColumns:void 0,isFluid:void 0,isOptimized:void 0,update:function(){}},o.blocks={self:o.container.self.find(t).not(s.ignore),length:0,update:function(){}},o.initialize=function(){o.container.self=$(n),o.blocks.self=o.container.self.find(t).not(s.ignore),o.container.self.css({position:"relative"}),o.blocks.self.css({position:"absolute"})},o.data.update=function(){o.data.columnWidth=o.container.self.data("stackgrid-column-width"),o.data.gutter=o.container.self.data("stackgrid-gutter"),o.data.numberOfColumns=o.container.self.data("stackgrid-number-of-columns"),o.data.isOptimized=o.container.self.data("stackgrid-is-optimized"),o.data.isFluid=o.container.self.data("stackgrid-is-fluid")},o.properties.update=function(){o.properties.columnWidth=o.data.columnWidth||s.columnWidth,o.properties.numberOfColumns=o.data.numberOfColumns||s.numberOfColumns,o.properties.gutter=void 0!==o.data.gutter?o.data.gutter:s.gutter,o.properties.isOptimized=void 0!==o.data.isOptimized?o.data.isOptimized:s.isOptimized,o.properties.isFluid=void 0!==o.data.isFluid?o.data.isFluid:s.isFluid},o.blocks.update=function(){o.blocks.self.width=o.properties.columnWidth,o.blocks.length=o.blocks.self.length},o.container.scale=function(){var t,e;o.container.height=0,o.container.width=o.blocks.length<o.computedNumberOfColumns?(o.properties.columnWidth+o.properties.gutter)*o.blocks.length:(o.properties.columnWidth+o.properties.gutter)*o.computedNumberOfColumns,o.container.self.children().each(function(){var t,e;return t=$(this),e=t.outerHeight()+parseInt(t.css("top")),e>o.container.height?o.container.height=e:void 0}),e=o.container.width+o.properties.gutter,t=o.container.height+o.properties.gutter,s.scale(o.container.self,e,t)},o.callback=function(){return o.container.scale()},o.plot.ordinal=function(t){var e,i,n;for(e=[],n=0;n<o.computedNumberOfColumns;)e[n]=0,n++;i=0,$.each(o.blocks.self,function(t,n){var r,u,a;return r=$(n),u=(o.properties.columnWidth+o.properties.gutter)*i+o.properties.gutter,a=e[i]+o.properties.gutter,s.move(r,u,a,o.callback),e[i]+=r.outerHeight()+o.properties.gutter,i<o.computedNumberOfColumns-1?i++:i=0}),t()},o.plot.optimized=function(t){var e,i,n,r,u,a;for(e=[],i=[],n=[],$.each(o.blocks.self,function(t,i){var n;return n=$(i),e[t]=n.outerHeight()}),u=0;u<o.computedNumberOfColumns;)i[u]=[u,0],n[u]=[u,e[u]],u++;r=0,a=-1,$.each(o.blocks.self,function(t,d){var c,l,p,m;if(c=$(d),t%o.computedNumberOfColumns===0&&(r=0,a++,a>0)){for(i.sort(function(t,e){return t[1]===e[1]?0:t[1]>e[1]?1:-1}),n=[],u=0;u<o.computedNumberOfColumns;)null!=e[t+u]&&(n[u]=[u,e[t+u]]),u++;n.sort(function(t,e){return t[1]===e[1]?0:t[1]>e[1]?-1:1})}for(l=void 0,u=0;u<n.length;)n[u][0]===r&&(l=u),u++;return p=(o.properties.columnWidth+o.properties.gutter)*i[l][0]+o.properties.gutter,m=i[l][1]+o.properties.gutter,s.move(c,p,m,o.callback),i[l][1]+=e[t]+o.properties.gutter,r++}),t()},o.build=function(){var t;o.computedNumberOfColumns=o.properties.numberOfColumns,o.properties.isFluid&&(t=Math.floor((c.width-o.properties.gutter)/(o.properties.columnWidth+o.properties.gutter)),o.properties.numberOfColumns!==t&&(a=!0,o.computedNumberOfColumns=t)),a&&(a=!1,o.properties.isOptimized?o.plot.optimized(function(){}):o.plot.ordinal(function(){})),o.container.scale()},r=function(){c.update(),o.initialize(),o.data.update(),o.properties.update(),o.blocks.update(),a=!0,o.build()},u=function(){c.update(),o.build()},d=function(){o.data.update(),o.properties.update(),a=!0,o.build()},$(function(){r()}),i.on("load resize stackgrid",function(){return window.requestAnimationFrame(u)}),i.on("load resize stackgrid-initialize",function(){return window.requestAnimationFrame(r)}),o.container.self.on("stackgrid-update",function(){return window.requestAnimationFrame(d)}),o.container.self.on("stackgrid-initialize",function(){return window.requestAnimationFrame(r)}),o.blocks.self}}(jQuery)}).call(this);