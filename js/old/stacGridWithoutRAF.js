(function(){!function($){$.fn.stackGrid=function(t,e){var i,o,n,r,u,s,a,l,d;return o=this,i=$(window),a=!0,d={width:0,height:0,update:function(){}},d.update=function(){d.width=i.width()},s=$.extend({ignore:null,columnWidth:196,numberOfColumns:4,gutter:16,isFluid:0,isOptimized:0,move:function(t,e,i,o){return t.stop().animate({left:e,top:i},o)},scale:function(t,e,i,o){return t.stop().animate({width:e,height:i})}},e),n={computedNumberOfColumns:0,plot:function(){}},n.properties={columnWidth:s.columnWidth,gutter:s.gutter,numberOfColumns:s.numberOfColumns,isFluid:s.isFluid,isOptimized:s.isOptimized,update:function(){}},n.container={self:$(o),width:0,height:0,scale:function(){}},n.data={columnWidth:void 0,gutter:void 0,numberOfColumns:void 0,isFluid:void 0,isOptimized:void 0,update:function(){}},n.blocks={self:n.container.self.find(t).not(s.ignore),length:0,update:function(){}},n.initialize=function(){n.container.self=$(o),n.blocks.self=n.container.self.find(t).not(s.ignore),n.container.self.css({position:"relative"}),n.blocks.self.css({position:"absolute"})},n.data.update=function(){n.data.columnWidth=n.container.self.data("stackgrid-column-width"),n.data.gutter=n.container.self.data("stackgrid-gutter"),n.data.numberOfColumns=n.container.self.data("stackgrid-number-of-columns"),n.data.isOptimized=n.container.self.data("stackgrid-is-optimized"),n.data.isFluid=n.container.self.data("stackgrid-is-fluid")},n.properties.update=function(){n.properties.columnWidth=n.data.columnWidth||s.columnWidth,n.properties.numberOfColumns=n.data.numberOfColumns||s.numberOfColumns,n.properties.gutter=void 0!==n.data.gutter?n.data.gutter:s.gutter,n.properties.isOptimized=void 0!==n.data.isOptimized?n.data.isOptimized:s.isOptimized,n.properties.isFluid=void 0!==n.data.isFluid?n.data.isFluid:s.isFluid},n.blocks.update=function(){n.blocks.self.width=n.properties.columnWidth,n.blocks.length=n.blocks.self.length},n.container.scale=function(){var t,e;n.container.height=0,n.container.width=n.blocks.length<n.computedNumberOfColumns?(n.properties.columnWidth+n.properties.gutter)*n.blocks.length:(n.properties.columnWidth+n.properties.gutter)*n.computedNumberOfColumns,n.container.self.children().each(function(){var t,e;return t=$(this),e=t.outerHeight()+parseInt(t.css("top")),e>n.container.height?n.container.height=e:void 0}),e=n.container.width+n.properties.gutter,t=n.container.height+n.properties.gutter,s.scale(n.container.self,e,t)},n.callback=function(){return n.container.scale()},n.plot.ordinal=function(t){var e,i,o;for(e=[],o=0;o<n.computedNumberOfColumns;)e[o]=0,o++;i=0,$.each(n.blocks.self,function(t,o){var r,u,a;return r=$(o),u=(n.properties.columnWidth+n.properties.gutter)*i+n.properties.gutter,a=e[i]+n.properties.gutter,s.move(r,u,a,n.callback),e[i]+=r.outerHeight()+n.properties.gutter,i<n.computedNumberOfColumns-1?i++:i=0}),t()},n.plot.optimized=function(t){var e,i,o,r,u,a;for(e=[],i=[],o=[],$.each(n.blocks.self,function(t,i){var o;return o=$(i),e[t]=o.outerHeight()}),u=0;u<n.computedNumberOfColumns;)i[u]=[u,0],o[u]=[u,e[u]],u++;r=0,a=-1,$.each(n.blocks.self,function(t,l){var d,c,p,f;if(d=$(l),t%n.computedNumberOfColumns===0&&(r=0,a++,a>0)){for(i.sort(function(t,e){return t[1]===e[1]?0:t[1]>e[1]?1:-1}),o=[],u=0;u<n.computedNumberOfColumns;)null!=e[t+u]&&(o[u]=[u,e[t+u]]),u++;o.sort(function(t,e){return t[1]===e[1]?0:t[1]>e[1]?-1:1})}for(c=void 0,u=0;u<o.length;)o[u][0]===r&&(c=u),u++;return p=(n.properties.columnWidth+n.properties.gutter)*i[c][0]+n.properties.gutter,f=i[c][1]+n.properties.gutter,s.move(d,p,f,n.callback),i[c][1]+=e[t]+n.properties.gutter,r++}),t()},n.build=function(){var t;n.computedNumberOfColumns=n.properties.numberOfColumns,n.properties.isFluid&&(t=Math.floor((d.width-n.properties.gutter)/(n.properties.columnWidth+n.properties.gutter)),n.properties.numberOfColumns!==t&&(a=!0,n.computedNumberOfColumns=t)),a&&(a=!1,n.properties.isOptimized?n.plot.optimized(function(){}):n.plot.ordinal(function(){})),n.container.scale()},r=function(){d.update(),n.initialize(),n.data.update(),n.properties.update(),n.blocks.update(),a=!0,n.build()},u=function(){d.update(),n.build()},l=function(){n.data.update(),n.properties.update(),a=!0,n.build()},$(function(){r()}),i.on("load resize stackgrid",u),i.on("load resize stackgrid-initialize",r),n.container.self.on("stackgrid-update",l),n.container.self.on("stackgrid-initialize",r),n.blocks.self}}(jQuery)}).call(this);